{
	"results": [
		{
			"rule_id": "AVD-AWS-0017",
			"long_id": "aws-cloudwatch-log-group-customer-key",
			"rule_description": "CloudWatch log groups should be encrypted using CMK",
			"rule_provider": "aws",
			"rule_service": "cloudwatch",
			"impact": "Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.",
			"resolution": "Enable CMK encryption of CloudWatch Log Groups",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/cloudwatch/log-group-customer-key/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id"
			],
			"description": "Log group is not encrypted.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_cloudwatch_log_group.alb_logs",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/23-monitoring.tf",
				"start_line": 2,
				"end_line": 10
			}
		},
		{
			"rule_id": "AVD-AWS-0017",
			"long_id": "aws-cloudwatch-log-group-customer-key",
			"rule_description": "CloudWatch log groups should be encrypted using CMK",
			"rule_provider": "aws",
			"rule_service": "cloudwatch",
			"impact": "Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.",
			"resolution": "Enable CMK encryption of CloudWatch Log Groups",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/cloudwatch/log-group-customer-key/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id"
			],
			"description": "Log group is not encrypted.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_cloudwatch_log_group.app_logs",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/23-monitoring.tf",
				"start_line": 13,
				"end_line": 21
			}
		},
		{
			"rule_id": "AVD-AWS-0017",
			"long_id": "aws-cloudwatch-log-group-customer-key",
			"rule_description": "CloudWatch log groups should be encrypted using CMK",
			"rule_provider": "aws",
			"rule_service": "cloudwatch",
			"impact": "Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.",
			"resolution": "Enable CMK encryption of CloudWatch Log Groups",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/cloudwatch/log-group-customer-key/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id"
			],
			"description": "Log group is not encrypted.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_cloudwatch_log_group.vpc_flow_logs",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/23-monitoring.tf",
				"start_line": 117,
				"end_line": 125
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.db_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/13-db-sg.tf",
				"start_line": 6,
				"end_line": 11
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.db_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/13-db-sg.tf",
				"start_line": 13,
				"end_line": 18
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.app_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/12-app-sg.tf",
				"start_line": 6,
				"end_line": 11
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.app_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/12-app-sg.tf",
				"start_line": 13,
				"end_line": 18
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 7,
				"end_line": 12
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 22,
				"end_line": 27
			}
		},
		{
			"rule_id": "AVD-AWS-0124",
			"long_id": "aws-ec2-add-description-to-security-group-rule",
			"rule_description": "Missing description for security group rule.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Descriptions provide context for the firewall rule reasons",
			"resolution": "Add descriptions for all security groups rules",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/add-description-to-security-group-rule/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
			],
			"description": "Security group rule does not have a description.",
			"severity": "LOW",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 15,
				"end_line": 20
			}
		},
		{
			"rule_id": "AVD-AWS-0130",
			"long_id": "aws-ec2-enforce-launch-config-http-token-imds",
			"rule_description": "aws_instance should activate session tokens for Instance Metadata Service.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Instance metadata service can be interacted with freely",
			"resolution": "Enable HTTP token requirement for IMDS",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/enforce-launch-config-http-token-imds/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options"
			],
			"description": "Launch template does not require IMDS access to require a token",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_launch_template.app_lt",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/19-launch-template.tf",
				"start_line": 17,
				"end_line": 43
			}
		},
		{
			"rule_id": "AVD-AWS-0104",
			"long_id": "aws-ec2-no-public-egress-sgr",
			"rule_description": "An egress security group rule allows traffic to /0.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Your port is egressing data to the internet",
			"resolution": "Set a more restrictive cidr range",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group"
			],
			"description": "Security group rule allows egress to multiple public internet addresses.",
			"severity": "CRITICAL",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.db_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/13-db-sg.tf",
				"start_line": 17,
				"end_line": 17
			}
		},
		{
			"rule_id": "AVD-AWS-0104",
			"long_id": "aws-ec2-no-public-egress-sgr",
			"rule_description": "An egress security group rule allows traffic to /0.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Your port is egressing data to the internet",
			"resolution": "Set a more restrictive cidr range",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group"
			],
			"description": "Security group rule allows egress to multiple public internet addresses.",
			"severity": "CRITICAL",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.app_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/12-app-sg.tf",
				"start_line": 17,
				"end_line": 17
			}
		},
		{
			"rule_id": "AVD-AWS-0104",
			"long_id": "aws-ec2-no-public-egress-sgr",
			"rule_description": "An egress security group rule allows traffic to /0.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Your port is egressing data to the internet",
			"resolution": "Set a more restrictive cidr range",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-egress-sgr/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group"
			],
			"description": "Security group rule allows egress to multiple public internet addresses.",
			"severity": "CRITICAL",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 26,
				"end_line": 26
			}
		},
		{
			"rule_id": "AVD-AWS-0107",
			"long_id": "aws-ec2-no-public-ingress-sgr",
			"rule_description": "An ingress security group rule allows traffic from /0.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Your port exposed to the internet",
			"resolution": "Set a more restrictive cidr range",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks"
			],
			"description": "Security group rule allows ingress from public internet.",
			"severity": "CRITICAL",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 19,
				"end_line": 19
			}
		},
		{
			"rule_id": "AVD-AWS-0107",
			"long_id": "aws-ec2-no-public-ingress-sgr",
			"rule_description": "An ingress security group rule allows traffic from /0.",
			"rule_provider": "aws",
			"rule_service": "ec2",
			"impact": "Your port exposed to the internet",
			"resolution": "Set a more restrictive cidr range",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/ec2/no-public-ingress-sgr/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks"
			],
			"description": "Security group rule allows ingress from public internet.",
			"severity": "CRITICAL",
			"warning": false,
			"status": 0,
			"resource": "aws_security_group.alb_sg",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/11-alb-sg.tf",
				"start_line": 11,
				"end_line": 11
			}
		},
		{
			"rule_id": "AVD-AWS-0053",
			"long_id": "aws-elb-alb-not-public",
			"rule_description": "Load balancer is exposed to the internet.",
			"rule_provider": "aws",
			"rule_service": "elb",
			"impact": "The load balancer is exposed on the internet",
			"resolution": "Switch to an internal load balancer or add a tfsec ignore",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/alb-not-public/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb"
			],
			"description": "Load balancer is exposed publicly.",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_lb.app_alb",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/17-alb.tf",
				"start_line": 3,
				"end_line": 3
			}
		},
		{
			"rule_id": "AVD-AWS-0052",
			"long_id": "aws-elb-drop-invalid-headers",
			"rule_description": "Load balancers should drop invalid headers",
			"rule_provider": "aws",
			"rule_service": "elb",
			"impact": "Invalid headers being passed through to the target of the load balance may exploit vulnerabilities",
			"resolution": "Set drop_invalid_header_fields to true",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/elb/drop-invalid-headers/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields"
			],
			"description": "Application load balancer is not set to drop invalid headers.",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_lb.app_alb",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/17-alb.tf",
				"start_line": 1,
				"end_line": 15
			}
		},
		{
			"rule_id": "AVD-AWS-0057",
			"long_id": "aws-iam-no-policy-wildcards",
			"rule_description": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
			"rule_provider": "aws",
			"rule_service": "iam",
			"impact": "Overly permissive policies may grant access to sensitive resources",
			"resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/iam/no-policy-wildcards/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document"
			],
			"description": "IAM policy document uses sensitive action 'logs:CreateLogGroup' on wildcarded resource '*'",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_iam_role_policy.vpc_flow_log_policy",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/23-monitoring.tf",
				"start_line": 154,
				"end_line": 154
			}
		},
		{
			"rule_id": "AVD-AWS-0065",
			"long_id": "aws-kms-auto-rotate-keys",
			"rule_description": "A KMS key is not configured to auto-rotate.",
			"rule_provider": "aws",
			"rule_service": "kms",
			"impact": "Long life KMS keys increase the attack surface when compromised",
			"resolution": "Configure KMS key to auto rotate",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/kms/auto-rotate-keys/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation"
			],
			"description": "Key does not have rotation enabled.",
			"severity": "MEDIUM",
			"warning": false,
			"status": 0,
			"resource": "aws_kms_key.db_secret_key",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/secrets.tf",
				"start_line": 2,
				"end_line": 9
			}
		},
		{
			"rule_id": "AVD-AWS-0177",
			"long_id": "aws-rds-enable-deletion-protection",
			"rule_description": "RDS Deletion Protection Disabled",
			"rule_provider": "aws",
			"rule_service": "rds",
			"impact": "",
			"resolution": "Modify the RDS instances to enable deletion protection.",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/rds/enable-deletion-protection/"
			],
			"description": "Instance does not have Deletion Protection enabled",
			"severity": "MEDIUM",
			"warning": false,
			"status": 0,
			"resource": "aws_db_instance.app_db",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/21-db-instance.tf",
				"start_line": 1,
				"end_line": 48
			}
		},
		{
			"rule_id": "AVD-AWS-0176",
			"long_id": "aws-rds-enable-iam-auth",
			"rule_description": "RDS IAM Database Authentication Disabled",
			"rule_provider": "aws",
			"rule_service": "rds",
			"impact": "",
			"resolution": "Modify the PostgreSQL and MySQL type RDS instances to enable IAM database authentication.",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/rds/enable-iam-auth/"
			],
			"description": "Instance does not have IAM Authentication enabled",
			"severity": "MEDIUM",
			"warning": false,
			"status": 0,
			"resource": "aws_db_instance.app_db",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/21-db-instance.tf",
				"start_line": 1,
				"end_line": 48
			}
		},
		{
			"rule_id": "AVD-AWS-0078",
			"long_id": "aws-rds-enable-performance-insights-encryption",
			"rule_description": "Encryption for RDS Performance Insights should be enabled.",
			"rule_provider": "aws",
			"rule_service": "rds",
			"impact": "Data can be read from the RDS Performance Insights if it is compromised",
			"resolution": "Enable encryption for RDS clusters and instances",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/rds/enable-performance-insights-encryption/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id"
			],
			"description": "Instance has performance insights enabled without encryption.",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_db_instance.app_db",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/21-db-instance.tf",
				"start_line": 1,
				"end_line": 48
			}
		},
		{
			"rule_id": "AVD-AWS-0095",
			"long_id": "aws-sns-enable-topic-encryption",
			"rule_description": "Unencrypted SNS topic.",
			"rule_provider": "aws",
			"rule_service": "sns",
			"impact": "The SNS topic messages could be read if compromised",
			"resolution": "Turn on SNS Topic encryption",
			"links": [
				"https://aquasecurity.github.io/tfsec/latest/checks/aws/sns/enable-topic-encryption/",
				"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse"
			],
			"description": "Topic does not have encryption enabled.",
			"severity": "HIGH",
			"warning": false,
			"status": 0,
			"resource": "aws_sns_topic.alerts",
			"location": {
				"filename": "/tmp/workspaces/c5a4981e-19a4-4e0b-86ae-4f64b4f0345f/code/23-monitoring.tf",
				"start_line": 95,
				"end_line": 102
			}
		}
	]
}
